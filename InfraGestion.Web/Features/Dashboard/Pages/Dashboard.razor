@page "/"
@using InfraGestion.Web.Features.Auth.Services
@using InfraGestion.Web.Core.Constants
@inject AuthService AuthService
@inject NavigationManager Navigation

<PageTitle>Dashboard - InfraCom</PageTitle>

<h1 class="page-title">Dashboard</h1>
<p class="page-description">Bienvenido al sistema de gesti√≥n de infraestructura.</p>

@code {
    protected override async Task OnInitializedAsync()
    {
        var user = await AuthService.GetCurrentUserAsync();

        if (user is null)
        {
            Navigation.NavigateTo("/login", replace: true);
            return;
        }

        var target = user.Role switch
        {
            Roles.Admin => "/admin/dashboard",
            Roles.Technician => "/technician/dashboard",
            Roles.Director => "/director/dashboard",
            Roles.Logistician => "/logistician/dashboard",
            Roles.Manager => "/manager/dashboard",
            _ => "/login"
        };

        Navigation.NavigateTo(target, replace: true);
    }
}